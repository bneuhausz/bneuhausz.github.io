const s=`---
title: Angular PWA tutorial part 3 - Node backend for sending push notifications
slug: angular-pwa-tutorial-part-3
description: In part 3 of this series, we will implement a simple node backend to be able to send push notifications
date: 2025-08-27
coverImage: /images/node_js_header.svg
coverImageMedium: /images/node_js_header.svg
coverImageSmall: /images/node_js_header.svg
coverImageDescription: nodejs image
metaImage: https://bneuhausz.dev/images/bneuhausz_dev_twitter.png
metaImageDescription: bneuhausz.dev site logo
thumbnail: /images/node_js_icon.svg
thumbnailDescription: Node.js logo
icon: /images/node_js_icon.svg
iconDescription: Node.js logo
tags: [JavaScript, PWA, Node.js, Express]
shadowColor: nodejs
draft: false
lastMod: 2025-08-28
---

<h1 id="angular-pwa-tutorial-part-3---node-backend-for-sending-push-notifications">Angular PWA tutorial part 3 - Node backend for sending push notifications</h1>
<blockquote>
<sub>
<b>Changelog:</b><br>
<b>2025-08-28:</b> Added link to part 4.<br>
</sub></blockquote>
<p>Sending push notifications is a bit more complex than what we&#39;ve dealt with before in this series and it requires a separate backend to provide security and reliability. In part 3 of this series, we will set up a very simple backend using Node.js and Express that will be more than enough for learning purposes.</p><p>You can find part 1 about the basic setup <a href="https://bneuhausz.dev/blog/angular-pwa-tutorial-part-1">here</a> and part 2 about notifying your users about a new version of your application being available <a href="https://bneuhausz.dev/blog/angular-pwa-tutorial-part-2">here.</a></p><h2 id="introducing-vapid">Introducing VAPID</h2>
<p>VAPID stands for Voluntary Application Server Identification. It is a security standard that allows push services to verify that the notification is coming from a legitimate application server and the server has permission to send messages to a specific user.</p><p>VAPID works using a public/private key pair. The public key can be safely shared with the client application, but the private key should be kept secret. The backend application will use the private key to sign the push requests you send and the push service will use the public key to verify the signature, to guarantee that:</p><ul>
<li>the request was sent by the authorized server</li>
<li>the message has not been tampered with</li>
</ul>
<p>Push services are provided by the browsers and their publishers (so Google or Mozilla for example), but in the past, if you wanted to send push notifications from a PWA, you had to register your app with each specific browser&#39;s push service to get an API key. VAPID enabled the standardization of this process.</p><p>This is likely more than enough to know about it, but in case you are interested, you can dive deeper <a href="https://datatracker.ietf.org/doc/html/draft-ietf-webpush-vapid-01">here.</a></p><h2 id="generating-your-vapid-keys">Generating your VAPID keys</h2>
<p>Later, we&#39;ll use the <a href="https://github.com/web-push-libs/web-push">web-push</a> package to send notifications, but we also need it to generate our VAPID keys, so let&#39;s install it:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> web-push</span><span style="color:#79B8FF"> -g</span></span></code></pre>
<p>Then, to generate our key pair, let&#39;s run the following:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">web-push</span><span style="color:#9ECBFF"> generate-vapid-keys</span><span style="color:#79B8FF"> --json</span></span></code></pre>
<p>The output should look something like this, obviously with different values:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">"publicKey"</span><span style="color:#E1E4E8">:</span><span style="color:#9ECBFF">"BFFkuSKeFvS13nlWyD..."</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">"privateKey"</span><span style="color:#E1E4E8">:</span><span style="color:#9ECBFF">"52igq5YWuyXCaXls..."</span><span style="color:#E1E4E8">}</span></span></code></pre>
<p>For now, we can put our keys aside, but do save them somewhere, because we will need them in a bit.</p><h2 id="creating-our-nodejs-application">Creating our Node.js application</h2>
<p>First, for the sake of simplicity, in the root folder of our application, create a folder named <code>push-notification-server</code>, open your terminal inside it and run the following:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> init</span><span style="color:#79B8FF"> -y</span></span></code></pre>
<p>This will initialize a Node.js project with default values. You should now see a <code>package.json</code> file in your folder, more or less with these contents:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#79B8FF">  "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"push-notification-server"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "version"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"1.0.0"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "main"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"index.js"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "scripts"</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#79B8FF">    "test"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"echo </span><span style="color:#79B8FF">\\"</span><span style="color:#9ECBFF">Error: no test specified</span><span style="color:#79B8FF">\\"</span><span style="color:#9ECBFF"> &#x26;&#x26; exit 1"</span></span>
<span class="line"><span style="color:#E1E4E8">  },</span></span>
<span class="line"><span style="color:#79B8FF">  "keywords"</span><span style="color:#E1E4E8">: [],</span></span>
<span class="line"><span style="color:#79B8FF">  "author"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "license"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"ISC"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "description"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">""</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>If that is done, create a file named <code>index.js</code> inside the <code>push-notification-server</code> folder.</p><p>Now we&#39;ll install some packages we will use in our application:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> express</span><span style="color:#9ECBFF"> web-push</span><span style="color:#9ECBFF"> body-parser</span><span style="color:#9ECBFF"> dotenv</span><span style="color:#9ECBFF"> cors</span></span></code></pre>
<p>With that, our basic setup is mostly done, let&#39;s get to the implementation.</p><h2 id="setting-up-the-environment">Setting up the environment</h2>
<p>First things first, let&#39;s set up <code>dotenv</code>. We&#39;ve already installed the package in the last section. Now, let&#39;s create a file in the <code>push-notification-server</code> folder and name it <code>.env</code>. In the GitHub repo for this project, you&#39;ll find a <code>.env-example</code> file with the following content:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#FFAB70">VAPID_PUBLIC_KEY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DUMMY PUBLIC KEY</span></span>
<span class="line"><span style="color:#FFAB70">VAPID_PRIVATE_KEY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DUMMY PRIVATE KEY</span></span></code></pre>
<p>Add this to your <code>.env</code> file and replace the dummy data with your generated VAPID keys. If you&#39;re done with that, let&#39;s get to <code>index.js</code>.</p><h2 id="writing-the-application-logic">Writing the application logic</h2>
<p>To get it out of the way, add the following to the top of <code>index.js</code>:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> express </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'express'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> webpush </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'web-push'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> bodyParser </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'body-parser'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dotenv </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'dotenv'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> cors </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'cors'</span><span style="color:#E1E4E8">;</span></span></code></pre>
<p>After this, we will have access to the packages we&#39;ve already installed. Now, to finish our environment setup and load the contents of the <code>.env</code> file into our application&#39;s environment, add the following line:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">dotenv.</span><span style="color:#B392F0">config</span><span style="color:#E1E4E8">();</span></span></code></pre>
<p>Then, to set up <code>web-push</code> with our VAPID keys:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">webpush.</span><span style="color:#B392F0">setVapidDetails</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#9ECBFF">  'mailto:example@example.com'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  process.env.</span><span style="color:#79B8FF">VAPID_PUBLIC_KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  process.env.</span><span style="color:#79B8FF">VAPID_PRIVATE_KEY</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span></code></pre>
<p>The <code>setVapidDetails</code> function accepts 3 parameters. The public and private keys are self-explanatory, but it also expects a <code>subject</code> parameter. For learning purposes, this is mostly irrelevant, so you can just add the dummy address I did, but in a production environment, you should set it up with a real email or a contact form you can be reached at. It accepts a <code>mailto:</code> or an <code>https:</code> URL and it is used by push services to contact you in case of technical issues or if your private key got leaked and somebody is abusing it for example.</p><p>Now add the skeleton of our Express API:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> app</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> express</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> port</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 3000</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">let</span><span style="color:#E1E4E8"> subscription;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">use</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">cors</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">  origin: </span><span style="color:#9ECBFF">'http://localhost:8080'</span></span>
<span class="line"><span style="color:#E1E4E8">}));</span></span>
<span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">use</span><span style="color:#E1E4E8">(bodyParser.</span><span style="color:#B392F0">json</span><span style="color:#E1E4E8">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">post</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/subscribe'</span><span style="color:#E1E4E8">, (</span><span style="color:#FFAB70">req</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Subscription received:'</span><span style="color:#E1E4E8">, req.body);</span></span>
<span class="line"><span style="color:#E1E4E8">  subscription </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> req.body;</span></span>
<span class="line"><span style="color:#E1E4E8">  res.</span><span style="color:#B392F0">status</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">201</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">json</span><span style="color:#E1E4E8">({ message: </span><span style="color:#9ECBFF">'subscription created'</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">post</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/notify'</span><span style="color:#E1E4E8">, (</span><span style="color:#FFAB70">req</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Current subscription:'</span><span style="color:#E1E4E8">, subscription);</span></span>
<span class="line"><span style="color:#E1E4E8">  res.</span><span style="color:#B392F0">status</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">204</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">listen</span><span style="color:#E1E4E8">(port, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">\`Server is running at http://localhost:\${</span><span style="color:#E1E4E8">port</span><span style="color:#9ECBFF">}\`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>Let me explain this. With the <code>express</code> function, we create our Express application, that we can access through the <code>app</code> variable. We set the <code>port</code> variable to 3000, which is a fairly standard port when developing Express applications.</p><p>The <code>subscription</code> variable will be used to store our active subscription. This is sufficient for learning, but the data will be lost every time our application is restarted, so make sure to use some kind of persistent storage in a production environment. Also, this approach handles only 1 subscriber at a time, so keep that in mind.</p><p>With the <code>cors</code> package, we configure our Express app to allow requests from the port 8080, where our client application runs. This can look wildly different depending on your production environment, but CORS is entirely out of scope of this tutorial. If you are interested, you can read about it <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CORS">here.</a></p><p>Then, we configure our app to use <code>body-parser</code> to automatically parse incoming requests with a JSON body and make the data available in <code>req.body</code>.</p><p>We&#39;ve added two <code>POST</code> endpoints to our application, namely <code>/subscribe</code> and <code>/notify</code>. These are just dummy endpoints for now, but we will expand on these in a moment, to handle our subscription and notification logic.</p><p>Finally, with <code>app.listen</code>, we set our application to listen on port 3000.</p><p>With all this set up, you can run your application with</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">node</span><span style="color:#9ECBFF"> index.js</span></span></code></pre>
<p>Make sure to run this command in the <code>push-notification-server</code> folder. If everything works correctly, you should see <code>Server is running at http://localhost:3000</code> on your terminal.</p><p>While our app is running, we can send <code>POST</code> requests with Postman or the tool of your choice and we should see something like this as the output:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">Server</span><span style="color:#9ECBFF"> is</span><span style="color:#9ECBFF"> running</span><span style="color:#9ECBFF"> at</span><span style="color:#9ECBFF"> http://localhost:3000</span></span>
<span class="line"><span style="color:#B392F0">Subscription</span><span style="color:#9ECBFF"> received:</span><span style="color:#9ECBFF"> {</span><span style="color:#9ECBFF"> test:</span><span style="color:#9ECBFF"> 'test'</span><span style="color:#9ECBFF"> }</span></span>
<span class="line"><span style="color:#B392F0">Current</span><span style="color:#9ECBFF"> subscription:</span><span style="color:#E1E4E8"> [ </span><span style="color:#9ECBFF">{</span><span style="color:#9ECBFF"> test:</span><span style="color:#9ECBFF"> 'test'</span><span style="color:#9ECBFF"> }</span><span style="color:#9ECBFF"> ]</span></span></code></pre>
<h2 id="implementing-subscription">Implementing subscription</h2>
<p>The subscription logic is very simple, we just add the incoming request body to our <code>subscription</code> variable. We will discuss the data we receive in the next post, when we will implement the frontend for this feature.</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">post</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/subscribe'</span><span style="color:#E1E4E8">, (</span><span style="color:#FFAB70">req</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  subscription </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> req.body;</span></span>
<span class="line"><span style="color:#E1E4E8">  res.</span><span style="color:#B392F0">status</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">201</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>As you can see, the final code is functionally the same as before, we&#39;ve just cleaned it up a little.</p><h2 id="sending-notifications">Sending notifications</h2>
<p>Since we have a very basic setup, this also becomes a fairly simple process. First, here is the complete endpoint:</p><pre class="shiki github-dark" style="background-color:#24292e;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">app.</span><span style="color:#B392F0">post</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/notify'</span><span style="color:#E1E4E8">, (</span><span style="color:#FFAB70">req</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> payload</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    notification: {</span></span>
<span class="line"><span style="color:#E1E4E8">      title: </span><span style="color:#9ECBFF">'Test notification'</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  webpush.</span><span style="color:#B392F0">sendNotification</span><span style="color:#E1E4E8">(subscription, </span><span style="color:#79B8FF">JSON</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">stringify</span><span style="color:#E1E4E8">(payload))</span></span>
<span class="line"><span style="color:#E1E4E8">    .</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> res.</span><span style="color:#B392F0">status</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">204</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">())</span></span>
<span class="line"><span style="color:#E1E4E8">    .</span><span style="color:#B392F0">catch</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">err</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">      console.</span><span style="color:#B392F0">error</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Error sending notification:'</span><span style="color:#E1E4E8">, err);</span></span>
<span class="line"><span style="color:#E1E4E8">      res.</span><span style="color:#B392F0">sendStatus</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">500</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>We have to create a notification. The only required field is the title, so we will go with that here, but you can set lots of things, like an icon or vibration patterns for example. You can read more about that <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification/Notification">here.</a></p><p>Then, we call <code>sendNotification</code> with our <code>subscription</code> and the stringified payload. That is literally all there is to it. Our application is ready to send notifications.</p><p>Again, we will discuss the contents of the <code>subscription</code> in the next part, when we implement the frontend, but until then, the complete code for this chapter is available <a href="https://github.com/bneuhausz/pwa-tutorial/tree/part-3">here.</a></p><p><a href="https://bneuhausz.dev/blog/angular-pwa-tutorial-part-4">Part 4 of this series, where we implement the frontend for our Express app has been released and you can find it here.</a></p>`;export{s as default};
