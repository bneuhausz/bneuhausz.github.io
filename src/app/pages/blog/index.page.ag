<script lang="ts">
  import { injectContentFiles } from '@analogjs/content';
  import BlogCard from './blog-card.analog' with { analog: 'imports' };
  import PostAttributes from '../../post-attributes';
  import { computed, signal } from '@angular/core';
  import { RouteMeta } from '@analogjs/router';

  export const routeMeta: RouteMeta = {
    title: 'Blog - bneuhausz.dev',
  };

  const posts = signal(injectContentFiles<PostAttributes>());

  const sortedPosts = computed(() => {
    return posts().sort((a, b) => {
      const dateA = new Date(a.attributes.date);
      const dateB = new Date(b.attributes.date);

      if (dateB.getTime() !== dateA.getTime()) {
        return dateB.getTime() - dateA.getTime();
      }

      return 0;
    });
  });
</script>

<template>
  <h1 class="text-3xl">Some of my thoughts are documented here.</h1>
  <p>
    I mostly write these as notes for myself, but if somehow you've got here, I hope you find them useful!
  </p>

  <section class="grid gap-8 grid-cols-[repeat(auto-fit,minmax(400px,1fr))] place-items-center py-8">
    @for (post of sortedPosts(); track post.attributes.slug) {
      <BlogCard [post]="post" />
    }
  </section>
</template>